var documenterSearchIndex = {"docs":
[{"location":"tutorials/branching-brownian-motion/#Branching-Brownian-motion","page":"Branching Brownian Motion","title":"Branching Brownian motion","text":"","category":"section"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"Branching Brownian motion (BBM) is the simplest example of a branching stochastic process. The process starts with a \"root\" particle undergoing Brownian motion. After an exponentially distributed lifetime, the particle dies and gives rise to a number of offspring particles, each evolving independently by the same mechanisms, with initial position given by the final position of the parent particle.","category":"page"},{"location":"tutorials/branching-brownian-motion/#Setting-up-the-problem","page":"Branching Brownian Motion","title":"Setting up the problem","text":"","category":"section"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"In SciML, a \"problem\" is the encoding of a mathematical problem into a numerically computable form. A branching stochastic process problem is defined mathematically by three ingredients:","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"a stochastic process defining the single-particle dynamics,\na branching rate,\na branching mechanism.","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"For BBM, the single-particle dynamics is Brownian motion, or more precisely, the Wiener process. It is defined in a distributionally exact manner in the DiffEqNoiseProcess package, but for now the BranchingProcesses package only supports SDEProblem or JumpProblem types. Hence we define the Wiener process as the SDEProblem:","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"using DifferentialEquations\nf(u,p,t) = 0.0\ng(u,p,t) = 1.0\nu0 = 0.0\ntspan = (0.0, 5.0)\nbm = SDEProblem(f,g, u0, tspan)","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"The branching rate is a constant,","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"λ = 1.0","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"and the branching mechanism, for now, is taken as deterministic splitting into two particles,","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"nchild = 2","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"The three ingredients defining BBM can now be packed in a ConstantRateBranchingProblem:","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"import BranchingProcesses as BP\nbbm = BP.ConstantRateBranchingProblem(bm, λ, nchild)","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"BranchingProcesses does not yet support branching with non-constant, that is, time and/or state-dependent branching rates.","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"note: Timespan of the branching process\nBy convention it is assumed that the timespan argument tspan used to define the single-particle dynamics problem is the requested timespan of the entire branching process. In other words, the branching process bbm will be simulated for the timespan:bbm.prob.tspan","category":"page"},{"location":"tutorials/branching-brownian-motion/#Sampling-a-trajectory","page":"Branching Brownian Motion","title":"Sampling a trajectory","text":"","category":"section"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"In SciML, sampling a trajectory of a stochastic process is done by solving the problem. BranchingProcesses follows this convention, and hence we can run:","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"using Random # hide\nRandom.seed!(123) # hide\ntree = solve(bbm, EM(); dt=0.01)","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"The (optional) second argument in the solve function specifies the algorithm used to simulate the single-particle dynamics, see the SDE solvers page for a full list of available algorithms. Any optional keyword arguments are also directly passed to the chosen single-particle simulation algorithm.","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"The output of solve is a BranchingProcessSolution, a tree structure where each node contains the solution (simulated trajector) of a particle in the branching process trajectory, as well as pointers to the solutions of its children.","category":"page"},{"location":"tutorials/branching-brownian-motion/","page":"Branching Brownian Motion","title":"Branching Brownian Motion","text":"using Plots\nplot(tree; linewidth=2)","category":"page"},{"location":"solvers/#Solvers","page":"Solvers","title":"Solvers","text":"","category":"section"},{"location":"solvers/#CommonSolve.solve","page":"Solvers","title":"CommonSolve.solve","text":"solve(bp::T, alg::A; kwargs...) where {T<:ConstantRateBranchingProblem, A<:Union{SciMLBase.AbstractSciMLAlgorithm,Nothing}}\n\nSolve a branching stochastic process with constant branching rate defined by the ConstantRateBranchingProblem bp. The positional argument alg and optional keyword arguments kwargs... are passed to the solver used to sample trajectories of the underlying SDE problem.\n\nSee also: ConstantRateBranchingProblem, solve_and_split_constantrate, common solver options\n\n\n\n\n\n","category":"function"},{"location":"solvers/#BranchingProcesses.solve_and_split_constantrate","page":"Solvers","title":"BranchingProcesses.solve_and_split_constantrate","text":"solve_and_split_constantrate(prob::T, λ::S, nchild::O, alg::A; kwargs...) where {T<:Union{SciMLBase.AbstractSDEProblem, SciMLBase.AbstractJumpProblem, SciMLBase.NoiseProblem}, S<:Real, O<:Union{Integer,DiscreteUnivariateDistribution}, A<:Union{SciMLBase.AbstractSciMLAlgorithm,Nothing}}\n\nRecursively solve a branching stochastic process where the single-particle dynamics is defined by the SDE problem prob, the branching rate is a constant λ, and the number of children nchild of each particle is either a non-negative integer or a discrete distribution from which the number of children is sampled. The positional argument alg and optional keyword arguments kwargs... are passed to the solver used to sample the trajectory of each particle.\n\nThe timespan of the problem prob defines the total time interval for the branching process. A lifetime for the first particle is sampled from an exponential distribution with rate λ. If the lifetime is larger than the total time interval, the problem is solved until the end of the original interval and a solution node is returned without children. If the lifetime is smaller than the total time interval, the problem is solved until the sampled lifetime, and a solution node is returned with recursively solved children for the remaining time interval.\n\nSee also: SDE problems, sample_lifetime_constantrate, common solver options\n\n\n\n\n\n","category":"function"},{"location":"solvers/#BranchingProcesses.sample_lifetime_constantrate","page":"Solvers","title":"BranchingProcesses.sample_lifetime_constantrate","text":"sample_lifetime_constantrate(λ::T) where T <: Real\n\nSample the lifetime of a particle when the branching rate is a constant λ independent of time or the value of the process. This is equivalent to sampling from an exponential distribution with rate λ.\n\nNote that this is not the same as a ConstantRateJump where the rate is only constant between jumps.\n\n\n\n\n\n","category":"function"},{"location":"solvers/#BranchingProcesses.sample_offspring","page":"Solvers","title":"BranchingProcesses.sample_offspring","text":"sample_offspring(nchild::O) where O<:Union{Integer,DiscreteUnivariateDistribution}\n\nSample the number of offspring for a particle. If the input nchild is an integer, that integer is returned. If nchild is a discrete distribution, a sample from that distribution is returned.\n\n\n\n\n\n","category":"function"},{"location":"#BranchingProcesses.jl","page":"Introduction","title":"BranchingProcesses.jl","text":"","category":"section"},{"location":"#BranchingProcesses.BranchingProcesses","page":"Introduction","title":"BranchingProcesses.BranchingProcesses","text":"Exports\n\nImports\n\nAbstractTrees\nBase\nCore\nDistributions\nDocStringExtensions\nRecipesBase\nSciMLBase\n\nBranchingProcesses\n\n(Image: Dev) (Image: Build Status)\n\nBranchingProcesses is a Julia package for simulation and parameter inference in branching stochastic processes, also known as branching particle systems. \n\nBranching stochastic processes are processes where \"particles\" (which could represent cells, individuals, or species depending on the context) have one or more degrees of freedom X(t) whose dynamics is described by a stationary Markov process. After a certain lifetime, a particle splits into kgeq 0 identical, independent offspring particles with probability p_k. This process is repeated indefinitely, producing a collection of N(t) particles at time t. Splitting happens with a rate function gamma(xtau) that may depend on the current state x and age tau of the particle.\n\nExamples of such processes are:\n\nClassical branching processes, which correspond to the case X(t)equiv 1.\nBranching Brownian motion\nBranching Ornstein-Uhlenbeck processes used in phylogenetic comparative methods\n\nAlthough the package can probably be used or extended for generic phylodynamic analyses, the dedicated PhyloTraits package will probably be more appropriate for that purpose.\n\nThe primary motivation for this package is to provide a framework for the analysis of a \"memory\" phenomenon that can occur in branching stochastic processes if the relaxation rate of the single-particle dynamics is slow relative to the branching rate. In this case the system can remember its initial state, or, put differently, large fluctuations early in the expansion can have a long-lasting effect on the state of the system. The study of this phenomenon implicitly traces its roots (no pun intended) to Luria and Delbrück's fluctuation analysis. More recently, it has been\n\nstudied mathematically in branching Ornstein-Uhlenbeck processes,\nobserved experimentally in proliferating cancer cell populations\nproposed as an important property of proliferating active matter\n\nStudying this phenomenon requires the analysis of fluctuations across multiple independent realizations of the branching process. This is in contrast to the more common use of branching processes in population and phylogenetics, where the focus is on the evolution of a single lineage.\n\nSupported stochastic processes\n\nThe aim is to support any process that can be implemented as a stochastic differential equation, jump process, or jump diffusion equation. \n\nSpecific processes that will be implemented in the package are:\n\nBrownian motion\nOrnstein-Uhlenbeck process\nBirth-death process\nThe stochastic gene expression models of Gorin et al (2022)\n\nSupported rate function\n\nAny valid constant or variable rate function. The default is a constant rate function with parameter 1, that is, the probability for a particle to be alive with lifetime tau is exp(-tau).\n\nSupported splitting distributions\n\nAny discrete univariate distribution (default: Dirac with parameter 2, that is, all particles split into two offspring particles).\n\n\n\n\n\n","category":"module"},{"location":"types/#Types","page":"Types","title":"Types","text":"","category":"section"},{"location":"types/#Problem-types","page":"Types","title":"Problem types","text":"","category":"section"},{"location":"types/#BranchingProcesses.ConstantRateBranchingProblem","page":"Types","title":"BranchingProcesses.ConstantRateBranchingProblem","text":"struct ConstantRateBranchingProblem{P<:SciMLBase.AbstractDEProblem, R<:Real, O<:Union{Integer, Distributions.DiscreteUnivariateDistribution, Distributions.UnivariateDistribution{Distributions.Discrete}, Distributions.DiscreteDistribution{Distributions.Univariate}}} <: BranchingProcesses.BranchingProblem\n\nA structure to define a branching stochastic process with constant branching rate.\n\nFields\n\nprob: The SDE or jump process problem defining the single-particle dynamics of the branching process, an instance of SciMLBase.AbstractSDEProblem or SciMLBase.AbstractJumpProblem.\nbranchrate: The branching rate of the process, which must be a positive real number.\nnchild: The number of children to be created for each particle, which can be a non-negative integer or a discrete distribution with non-negative support from which the number of children is sampled.\n\n\n\n\n\n","category":"type"},{"location":"types/#Solution-types","page":"Types","title":"Solution types","text":"","category":"section"},{"location":"types/#BranchingProcesses.BranchingProcessSolution","page":"Types","title":"BranchingProcesses.BranchingProcessSolution","text":"struct BranchingProcessSolution{T<:Union{SciMLBase.DESolution, SciMLBase.SciMLSolution}}\n\nA tree structure to hold a solution of a branching stochastic process.\n\nFields\n\nsol: The solution, that is, sample trajectory, of the particle associated to the node, which is an instance of SciMLBase.AbstractSciMLSolution.\nchildren: a vector of BranchingProcessSolution instances representing the child particles of the current particle.\n\nThe solution type T must be the same for all nodes in the tree.\n\n\n\n\n\n","category":"type"},{"location":"types/#AbstractTrees.children","page":"Types","title":"AbstractTrees.children","text":"AbstractTrees.children(node::BranchingProcessSolution)\n\nReturn the children of a BranchingProcessSolution node.\n\n\n\n\n\n","category":"function"},{"location":"types/#AbstractTrees.nodevalue","page":"Types","title":"AbstractTrees.nodevalue","text":"AbstractTrees.nodevalue(node::BranchingProcessSolution)\n\nReturn the value of a BranchingProcessSolution node, defined as its final state value.\n\n\n\n\n\n","category":"function"}]
}
